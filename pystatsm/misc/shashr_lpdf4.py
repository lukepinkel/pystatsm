#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Thu May  4 23:40:42 2023

@author: lukepinkel
"""

import numpy as np
CONST = -1/2*np.log(np.pi) - 1/2*np.log(2)

def _logpdf4(y, m, s, t, v):  
    x0 = v + np.exp(t)*np.arcsinh((m - y)*np.exp(-s))
    lnp = t - 1/2*np.log(m**2 - 2*m*y + y**2 + np.exp(2*s)) +\
           np.log(np.cosh(x0)) - 1/2*np.sinh(x0)**2 + CONST# -1/2*np.log(np.pi) - 1/2*np.log(2)
            
    x1 = 2*y
    x2 = 2*s
    x3 = np.exp(x2)
    x4 = m**2 - m*x1 + x3 + y**2
    x5 = 1/x4
    x6 = 2*m - x1
    x7 = (1/2)*x6
    x8 = np.exp(t)
    x9 = np.exp(-s)
    x10 = m - y
    x11 = x10*x9
    x12 = np.arcsinh(x11)
    x13 = x12*x8
    x14 = v + x13
    x15 = np.sinh(x14)
    x16 = np.cosh(x14)
    x17 = x15*x16
    x18 = np.exp(-x2)
    x19 = x10**2
    x20 = x18*x19
    x21 = x20 + 1
    x22 = 1/np.sqrt(x21)
    x23 = x22*x9
    x24 = x23*x8
    x25 = 1/x16
    x26 = x15*x25
    x27 = x17*x24 - x24*x26
    x28 = x3*x5
    x29 = x11*x22
    x30 = x29*x8
    x31 = x17*x30
    x32 = x26*x30
    x33 = x13*x17
    x34 = -x6
    x35 = x4**(-2)
    x36 = x35*x6
    x37 = np.exp(2*t)
    x38 = 1/x21
    x39 = x16**2
    x40 = x37*x38
    x41 = x18*x40
    x42 = x39*x41
    x43 = x15**2
    x44 = x41*x43
    x45 = 1/x39
    x46 = x43*x45
    x47 = x21**(-3/2)
    x48 = np.exp(-3*s)
    x49 = x47*x48
    x50 = x49*x8
    x51 = x26*x50
    x52 = -1/2*x15*x16*x47*x48*x6*x8 + x51*x7
    x53 = x3*x36
    x54 = x10*x41
    x55 = x10*x42
    x56 = x10*x44
    x57 = x19*x50
    x58 = x26*x57
    x59 = x17*x57
    x60 = x58 - x59
    x61 = x27 + x60
    x62 = x12*x37
    x63 = x23*x62
    x64 = x39*x63
    x65 = x43*x63
    x66 = x27 + x46*x63 - x63 + x64 + x65
    x67 = x24*x39 + x24*x43 + x24*x46 - x24
    x68 = 4*s
    x69 = np.exp(x68)
    x70 = x20*x40
    x71 = x39*x70
    x72 = x43*x70
    x73 = x31 - x32
    x74 = x10**3
    x75 = x50*x74
    x76 = x26*x75
    x77 = -x15*x16*x47*x48*x74*x8 + x76
    x78 = x29*x62
    x79 = x39*x78
    x80 = x43*x78
    x81 = x46*x78 + x73 - x78 + x79 + x80
    x82 = x30*x39 + x30*x43 + x30*x46 - x30
    x83 = x12**2
    x84 = x37*x83
    x85 = x39*x84
    x86 = x43*x84
    x87 = -x12*x15*x25*x8 + x33
    x88 = -x12*x8 + x13*x39 + x13*x43 + x13*x46
    x89 = 2*x35
    x90 = x4**(-3)
    x91 = -4*m + 4*y
    x92 = x34*x91
    x93 = x90*x92
    x94 = x21**(-2)
    x95 = np.exp(-x68)
    x96 = x94*x95
    x97 = x37*x96
    x98 = x6*x97
    x99 = np.exp(3*t)
    x100 = x15**3
    x101 = x16**(-3)
    x102 = 2*x26
    x103 = x49*x99
    x104 = x102*x103
    x105 = 4*x17
    x106 = x103*x105
    x107 = np.exp(-5*s)
    x108 = x6**2
    x109 = x21**(-5/2)
    x110 = (3/4)*x108
    x111 = x107*x109
    x112 = x111*x8
    x113 = x110*x112
    x114 = -3/4*x107*x108*x109*x15*x25*x8 + x113*x17 - x15*x16*x47*x48*x8 + x51
    x115 = x19*x97
    x116 = 2*x115
    x117 = x6*x90
    x118 = x10*x97
    x119 = x118*x7
    x120 = x100*x101
    x121 = 2*x120
    x122 = x103*x121
    x123 = x118*x39
    x124 = x118*x43
    x125 = 2*x41
    x126 = x125*x46 - x125 + 2*x42 + 2*x44
    x127 = x17*x50
    x128 = (3/2)*x6
    x129 = x112*x128
    x130 = x129*x19
    x131 = -x127*x128 + x128*x51 + x130*x17 - x130*x26
    x132 = x49*x62
    x133 = x18*x38
    x134 = x12*x133
    x135 = x134*x99
    x136 = x102*x135
    x137 = x105*x135
    x138 = x50*x7
    x139 = x43*x50
    x140 = x39*x50
    x141 = x117*x69
    x142 = 3*x97
    x143 = x104*x19
    x144 = x106*x19
    x145 = -x105*x57
    x146 = x10**4
    x147 = 3*x112
    x148 = x146*x147
    x149 = 4*x57
    x150 = -3*x107*x109*x146*x15*x25*x8 + x145 + x148*x17 + x149*x26
    x151 = 2*x54
    x152 = x132*x19
    x153 = x152*x39
    x154 = x152*x43
    x155 = -x39*x57 - x43*x57 - x46*x57 + x57
    x156 = 3*x63
    x157 = x23*x83
    x158 = x157*x99
    x159 = x102*x158 + x105*x158 - x121*x158 + x156*x46 - x156 + 3*x64 + 3*x65
    x160 = x102*x63 + x105*x63 - x121*x63 + x67
    x161 = x102*x24 + x105*x24 - x121*x24
    x162 = 6*s
    x163 = np.exp(x162)
    x164 = 8*x90
    x165 = 3*x70
    x166 = x142*x146
    x167 = x122*x74
    x168 = -x105*x75
    x169 = x10**5
    x170 = x147*x169
    x171 = 4*x75
    x172 = x168 + x17*x170 - x170*x26 + x171*x26
    x173 = 2*x70
    x174 = x132*x74
    x175 = x20*x38
    x176 = x12*x175
    x177 = x176*x99
    x178 = -x39*x47*x48*x74*x8 - x43*x45*x47*x48*x74*x8 - x43*x47*x48*x74*x8 + x75
    x179 = 3*x78
    x180 = x29*x83
    x181 = x180*x99
    x182 = x102*x181 + x105*x181 - x121*x181 + x179*x46 - x179 + x73 + 3*x79 + 3*x80
    x183 = x102*x78 + x105*x78 - x121*x78 + x82
    x184 = x102*x30 + x105*x30 - x121*x30
    x185 = x12**3
    x186 = x185*x99
    x187 = -2*x100*x101*x12*x8 + x102*x13 + x105*x13
    x188 = 4*x97
    x189 = np.exp(4*t)
    x190 = 2*x189
    x191 = x190*x96
    x192 = np.exp(-x162)
    x193 = x21**(-3)
    x194 = 4*x43
    x195 = x189*x96
    x196 = x194*x195
    x197 = 4*x39
    x198 = x195*x197
    x199 = x4**(-4)
    x200 = (15/4)*x108
    x201 = x192*x193*x37
    x202 = x200*x201
    x203 = 6*x15**4/x16**4
    x204 = x195*x203
    x205 = x112*x17
    x206 = 8*m - 8*y
    x207 = np.exp(-7*s)
    x208 = x6**3
    x209 = x21**(-7/2)
    x210 = x207*x209*x8
    x211 = x210*x26
    x212 = x120*x6
    x213 = x111*x99
    x214 = 6*x213
    x215 = 6*x98
    x216 = x201*x6
    x217 = 6*x19
    x218 = x216*x217
    x219 = x199*x6
    x220 = x10*x110*x201
    x221 = 12*x17
    x222 = 8*x46
    x223 = x195*x222
    x224 = x213*x217
    x225 = x147*x19
    x226 = x112*x26
    x227 = x10*x17*x6
    x228 = x26*x6
    x229 = x10*x213
    x230 = 3*x212
    x231 = x17*x210
    x232 = x19*x200
    x233 = 6*x103
    x234 = x120*x233
    x235 = x233*x26
    x236 = x103*x221
    x237 = -x234 + x235 + x236
    x238 = x12*x49
    x239 = x190*x238
    x240 = 3*x98
    x241 = x189*x238
    x242 = x197*x241
    x243 = x194*x241
    x244 = x203*x241
    x245 = x111*x62
    x246 = x110*x245
    x247 = x12*x96
    x248 = x247*x99
    x249 = 2*x99
    x250 = x249*x49
    x251 = x103*x194
    x252 = x103*x197
    x253 = x103*x203
    x254 = x146*x201
    x255 = 8*x254
    x256 = x118*x6
    x257 = 10*x120
    x258 = x10*x103
    x259 = 10*x26
    x260 = 20*x17
    x261 = (7/2)*x216*x74
    x262 = 4*x41
    x263 = x194*x41 + x197*x41
    x264 = x262*x46 - x262 + x263
    x265 = x188*x19
    x266 = 4*x135
    x267 = 8*x17
    x268 = x128*x19*x245
    x269 = x19*x248
    x270 = x222*x241
    x271 = 4*x269
    x272 = x10*x248
    x273 = -x128*x132*x39 - x128*x132*x43 - x128*x132*x46 + x128*x132 + x264
    x274 = x103*x222
    x275 = -x120*x262 + x26*x262 + x267*x41
    x276 = x133*x83
    x277 = x190*x276
    x278 = x189*x276
    x279 = x197*x278
    x280 = x194*x278
    x281 = x203*x278
    x282 = x135*x259
    x283 = x135*x260
    x284 = x134*x249
    x285 = x135*x197
    x286 = x135*x194
    x287 = x135*x203
    x288 = 15*x201
    x289 = x169*x288
    x290 = 7*x54
    x291 = x74*x97
    x292 = 22*x291
    x293 = 27*x146
    x294 = 24*x17
    x295 = x146*x213
    x296 = x10**6
    x297 = 15*x296
    x298 = 12*x295
    x299 = x103*x19
    x300 = 12*x120
    x301 = 12*x26
    x302 = 6*x291
    x303 = 3*x245
    x304 = x146*x303
    x305 = 6*x54
    x306 = x10*x135
    x307 = 6*x248
    x308 = 4*x54
    x309 = 3*x152
    x310 = x194*x54 + x197*x54
    x311 = x185*x23
    x312 = x189*x311
    x313 = x146*x97
    x314 = x288*x296
    x315 = x10**7
    x316 = x103*x74
    x317 = 6*x70
    x318 = 6*x313
    x319 = x169*x303
    x320 = 4*x174
    x321 = 6*x177
    x322 = x146*x307
    x323 = x175*x83
    x324 = x189*x323
    x325 = 4*x70
    x326 = x194*x70 + x197*x70
    x327 = 7*x78
    x328 = x185*x29
    x329 = x189*x328
    x330 = 6*x78
    x331 = x12**4
    x332 = x189*x331
    x333 = x15*x25
    x334 = x46*x54
    x335 = x46*x70
    x336 = x46*x84
    x337 = x3*x34
    x338 = x10*x135
    x339 = (3/4)*x206
    x340 = (15/8)*x208
    x341 = 2*x6*x90
    x342 = x94*x95
    x343 = x43*x45
    x344 = x107*x109
    x345 = x344*x99
    x346 = x15*x16
    x347 = x333*x344*x8
    x348 = x19*x213
    x349 = x128*x50
    x350 = 6*x26
    x351 = x194 + x197 + x203 + 2
    
    d1L = np.zeros(y.shape+(4,))
    d1L[...,0] = -x27 - x5*x7
    d1L[...,1] = -x28 + x31 - x32
    d1L[...,2] = x13*x26 - x33 + 1
    d1L[...,3] = -x17 + x333
    
    
    
    
    
    d2L = np.zeros(y.shape+(10,))
    d2L[...,0] = x18*x37*x38 - 1/2*x34*x36 - x41*x46 - x42 - x44 - x5 - x52
    d2L[...,1] = x334 + x53 - x54 + x55 + x56 + x61
    d2L[...,2] = -x66
    d2L[...,3] = -x67
    d2L[...,4] = x18*x19*x37*x38 - 2*x28 - x335 + 2*x35*x69 - x71 - x72 - x73 - x77
    d2L[...,5] = x81
    d2L[...,6] = x82
    d2L[...,7] = -x336 + x37*x83 - x85 - x86 - x87
    d2L[...,8] = -x88
    d2L[...,9] = -x39 - x43 - x46 + 1
    
    
    
    
    
    d3L = np.zeros(y.shape+(20,))
    d3L[...,0] = 2*x100*x101*x47*x48*x99 - x104 - x106 - x114 - x34*x89 + x35*x6 + (3/2)*x37*x39*x6*x94*x95 + (3/2)*x37*x43*x45*x6*x94*x95 + (3/2)*x37*x43*x6*x94*x95 - x7*x93 - 3/2*x98
    d3L[...,1] = x10*x104 + x10*x106 - x10*x122 - x116*x39 - x116*x43 - x116*x46 + x116 + 2*x117*x337 - x119*x46 + x119 - x123*x7 - x124*x7 + x126 + x131 + x3*x89
    d3L[...,2] = 2*x100*x101*x12*x18*x38*x99 + (1/2)*x12*x37*x39*x47*x48*x6 + (1/2)*x12*x37*x43*x45*x47*x48*x6 + (1/2)*x12*x37*x43*x47*x48*x6 - x126 - x132*x7 - x136 - x137 - x52
    d3L[...,3] = -x102*x41 - x105*x41 + x121*x41 + x138*x46 - x138 + x139*x7 + x140*x7
    d3L[...,4] = 3*x10*x18*x37*x38 + 2*x100*x101*x19*x47*x48*x99 - 4*x141 - x142*x74 - x143 - x144 - x150 - x27 + 2*x3*x35*x6 - 3*x334 + 3*x37*x39*x74*x94*x95 + 3*x37*x43*x45*x74*x94*x95 + 3*x37*x43*x74*x94*x95 - 3*x55 - 3*x56
    d3L[...,5] = x10*x136 + x10*x137 - x121*x338 + x151*x46 - x151 - x152*x46 + x152 - x153 - x154 + 2*x55 + 2*x56 + x60 + x66
    d3L[...,6] = x102*x54 + x105*x54 - x121*x54 + x155 + x67
    d3L[...,7] = -x159 - x27
    d3L[...,8] = -x160
    d3L[...,9] = -x161
    d3L[...,10] = x104*x74 + x106*x74 - x163*x164 + x165*x46 - x165 - x166*x39 - x166*x43 - x166*x46 + x166 - x167 + x172 - 4*x28 + 12*x35*x69 + 3*x71 + 3*x72 + x73
    d3L[...,11] = 2*x100*x101*x12*x18*x19*x38*x99 - x102*x177 - x105*x177 + x12*x37*x39*x47*x48*x74 + x12*x37*x43*x45*x47*x48*x74 + x12*x37*x43*x47*x48*x74 - x173*x46 + x173 - x174 - 2*x71 - 2*x72 - x77 - x81
    d3L[...,12] = 2*x100*x101*x18*x19*x37*x38 - x102*x70 - x105*x70 - x178 - x82
    d3L[...,13] = x182
    d3L[...,14] = x183
    d3L[...,15] = x184
    d3L[...,16] = 2*x100*x101*x185*x99 - x102*x186 - x105*x186 - 3*x336 + 3*x37*x83 - 3*x85 - 3*x86 - x87
    d3L[...,17] = 2*x100*x101*x37*x83 - x102*x84 - x105*x84 - x88
    d3L[...,18] = -x187
    d3L[...,19] = 2*x100*x101 - x102 - x105
    
    
    
    
    
    d4L = np.zeros(y.shape+(35,))
    d4L[...,0] = (15/4)*x108*x192*x193*x37 - x129*x17 - x188 + 8*x189*x342*x343 - x191 - x196 - x198 + 6*x199*x7*x92*(m - y) - x202*x39 - x202*x43 - x202*x46 - x204 - x205*x339 + x207*x209*x340*x346*x8 - x211*x340 - x212*x214 + 6*x333*x345*x6 + x339*x347 + x34*x341 + x341*x91 + 4*x342*x343*x37 + 4*x342*x37*x39 + 4*x342*x37*x43 + 12*x345*x346*x6 + (3/2)*x347*x6 + 6*x35 - 3*x93
    d4L[...,1] = x10*x191 + x10*x196 + x10*x198 + x10*x204 - x10*x223 - 4*x117*x3 - x118*x46 + x118 + x120*x224 - x123 - x124 - 3*x127 + x164*x337 + x17*x225 + x200*x205 - x200*x226 + x211*x232 - x214*x227 - x215*x39 - x215*x43 - x215*x46 + x215 + x218*x39 + x218*x43 + x218*x46 - x218 + 3*x219*x3*x92 + x220*x39 + x220*x43 + x220*x46 - x220 - x221*x348 - x224*x26 - x225*x26 - 3*x228*x229 + x229*x230 - x231*x232 + x237 + 3*x51
    d4L[...,2] = (3/4)*x107*x108*x109*x12*x37 - x114 + 6*x12*x15*x16*x6*x94*x95*x99 + 3*x12*x15*x25*x6*x94*x95*x99 + 8*x12*x189*x43*x45*x47*x48 + x12*x37*x39*x47*x48 + x12*x37*x43*x45*x47*x48 + x12*x37*x43*x47*x48 - x132 - x230*x248 - x237 - x239 - x240 - x242 - x243 - x244 - x246*x39 - x246*x43 - x246*x46 + 3*x37*x39*x6*x94*x95 + 3*x37*x43*x45*x6*x94*x95 + 3*x37*x43*x6*x94*x95
    d4L[...,3] = (3/4)*x107*x108*x109*x8 - x113*x39 - x113*x43 - x113*x46 - x120*x240 + 6*x15*x16*x37*x6*x94*x95 + 3*x15*x25*x37*x6*x94*x95 - x250 - x251 - x252 - x253 + x39*x47*x48*x8 + x43*x45*x47*x48*x8 + 8*x43*x45*x47*x48*x99 + x43*x47*x48*x8 - x50
    d4L[...,4] = 10*x10*x100*x101*x47*x48*x99 + (7/2)*x10*x37*x39*x6*x94*x95 + (7/2)*x10*x37*x43*x45*x6*x94*x95 + (7/2)*x10*x37*x43*x6*x94*x95 + 2*x107*x109*x15*x16*x19*x6*x99 + 20*x107*x109*x15*x16*x74*x99 + 12*x107*x109*x15*x19*x25*x6*x8 + x107*x109*x15*x19*x25*x6*x99 + 10*x107*x109*x15*x25*x74*x99 - x112*x19*x221*x6 - 12*x115 + (15/2)*x146*x15*x16*x207*x209*x6*x8 + 8*x146*x192*x193*x37 - 15/2*x146*x210*x228 + (9/2)*x15*x16*x47*x48*x6*x8 - x164*x69 + 8*x189*x19*x43*x45*x94*x95 - x19*x191 - x19*x196 - x19*x198 - x19*x204 + 12*x19*x37*x39*x94*x95 + 12*x19*x37*x43*x45*x94*x95 + 12*x19*x37*x43*x94*x95 + (7/2)*x192*x193*x37*x6*x74 - x212*x348 - x213*x257*x74 - 12*x219*x34*x69 - x222*x254 - x255*x39 - x255*x43 - 7/2*x256 - x258*x259 - x258*x260 - x261*x39 - x261*x43 - x261*x46 - x264 + 4*x3*x34*x6*x90 + 4*x3*x35 - 9/2*x51*x6
    d4L[...,5] = -x10*x234 + x10*x235 + x10*x236 + x10*x239 + x10*x242 + x10*x243 + x10*x244 - x10*x270 - x115*x194 - x115*x197 - x120*x266 + x120*x271 - x123*x6 - x124*x6 + x131 + x135*x267 + x212*x272 - x227*x247*x249 - x228*x272 - x256*x46 + x256 + x26*x266 - x26*x271 - x265*x46 + x265 - x267*x269 + x268*x39 + x268*x43 + x268*x46 - x268 + x273
    d4L[...,6] = x10*x250 + x10*x251 + x10*x252 + x10*x253 - x10*x274 - x115*x267 + x120*x256 + x120*x265 - x128*x139 - x128*x140 + x130*x39 + x130*x43 + x130*x46 - x130 - 2*x17*x256 - x256*x26 - x26*x265 + x275 - x349*x46 + x349
    d4L[...,7] = 10*x100*x101*x12*x18*x38*x99 - x103*x212*x83 + 2*x15*x16*x47*x48*x6*x83*x99 + x15*x25*x47*x48*x6*x83*x99 + 8*x18*x189*x38*x43*x45*x83 - x273 - x277 - x279 - x280 - x281 - x282 - x283 - x52
    d4L[...,8] = 2*x12*x15*x16*x37*x47*x48*x6 + x12*x15*x25*x37*x47*x48*x6 + 8*x12*x18*x38*x43*x45*x99 - x132*x212 - x138 - x275 - x284 - x285 - x286 - x287 + (1/2)*x39*x47*x48*x6*x8 + (1/2)*x43*x45*x47*x48*x6*x8 + (1/2)*x43*x47*x48*x6*x8
    d4L[...,9] = -x125 + 2*x15*x16*x47*x48*x6*x8 + x15*x25*x47*x48*x6*x8 + 8*x18*x37*x38*x43*x45 - x203*x41 - x212*x50 - x263
    d4L[...,10] = x120*x298 - 24*x141 + 24*x163*x219 + x191*x74 + x196*x74 + x198*x74 + x204*x74 + x205*x293 + x211*x297 - x223*x74 - x226*x293 - x231*x297 - x26*x298 + x27 + x289*x39 + x289*x43 + x289*x46 - x289 + x290*x46 - x290 - x292*x39 - x292*x43 - x292*x46 + x292 - x294*x295 + x294*x299 - x299*x300 + x299*x301 + 4*x53 + 7*x55 + 7*x56 + 13*x58 - 13*x59
    d4L[...,11] = 6*x10*x100*x101*x12*x18*x38*x99 + 6*x10*x18*x37*x38 + 6*x100*x101*x19*x47*x48*x99 - x103*x217*x26 + 3*x107*x109*x12*x146*x37 + 12*x12*x15*x16*x74*x94*x95*x99 + 6*x12*x15*x25*x74*x94*x95*x99 + 8*x12*x189*x19*x43*x45*x47*x48 + 4*x12*x19*x37*x39*x47*x48 + 4*x12*x19*x37*x43*x45*x47*x48 + 4*x12*x19*x37*x43*x47*x48 - x120*x307*x74 - x150 - 4*x152 - x19*x236 - x19*x239 - x19*x242 - x19*x243 - x19*x244 - x221*x306 - x302 - x304*x39 - x304*x43 - x304*x46 - x305*x46 - x306*x350 + 6*x37*x39*x74*x94*x95 + 6*x37*x43*x45*x74*x94*x95 + 6*x37*x43*x74*x94*x95 - 6*x55 - 6*x56 - x66
    d4L[...,12] = 6*x10*x100*x101*x18*x37*x38 + 3*x107*x109*x146*x8 - x120*x302 - x148*x39 - x148*x43 - x148*x46 - x149 + 12*x15*x16*x37*x74*x94*x95 + 6*x15*x25*x37*x74*x94*x95 - x19*x250 - x19*x251 - x19*x252 - x19*x253 + 4*x19*x39*x47*x48*x8 + 4*x19*x43*x45*x47*x48*x8 + 8*x19*x43*x45*x47*x48*x99 + 4*x19*x43*x47*x48*x8 - x221*x54 - x26*x305 - x67
    d4L[...,13] = -x10*x222*x278 + x10*x277 + x10*x279 + x10*x280 + x10*x281 + x10*x282 + x10*x283 + x122*x19*x83 - x143*x83 - x144*x83 - 3*x153 - 3*x154 + x159 - x257*x338 + x308*x46 - x308 - x309*x46 + x309 + x310 + x61
    d4L[...,14] = x10*x284 + x10*x285 + x10*x286 + x10*x287 - x102*x152 - x105*x152 - x120*x308 + x121*x152 + x155 + x160 - x222*x338 + x26*x308 + x267*x54
    d4L[...,15] = -x102*x57 + x121*x57 + x145 + x151 + x161 + x203*x54 - x222*x54 + x310
    d4L[...,16] = 12*x100*x101*x22*x83*x9*x99 + 7*x12*x22*x37*x9 - x158*x294 - x158*x301 + 8*x185*x189*x22*x43*x45*x9 - x190*x311 - x194*x312 - x197*x312 - x203*x312 - x27 - 7*x46*x63 - 7*x64 - 7*x65
    d4L[...,17] = 6*x100*x101*x12*x22*x37*x9 - x157*x249 - x158*x194 - x158*x197 - x158*x203 + 8*x22*x43*x45*x83*x9*x99 - x221*x63 - x350*x63 - x67
    d4L[...,18] = 8*x12*x22*x37*x43*x45*x9 - x161 - x194*x63 - x197*x63 - x203*x63 - 2*x63
    d4L[...,19] = -x194*x24 - x197*x24 - x203*x24 + 8*x22*x43*x45*x8*x9 - 2*x24
    d4L[...,20] = 12*x100*x101*x47*x48*x74*x99 + 24*x107*x109*x15*x16*x169*x99 + 27*x107*x109*x15*x169*x25*x8 + 12*x107*x109*x15*x169*x25*x99 + 8*x146*x189*x43*x45*x94*x95 - x146*x191 - x146*x196 - x146*x198 - x146*x204 + 22*x146*x37*x39*x94*x95 + 22*x146*x37*x43*x45*x94*x95 + 22*x146*x37*x43*x94*x95 + 15*x15*x16*x207*x209*x315*x8 + 13*x15*x16*x47*x48*x74*x8 - 96*x163*x90 - 27*x169*x205 - x169*x213*x300 + 7*x18*x19*x37*x38 + 15*x192*x193*x296*x37 + 48*x199*np.exp(8*s) - 15*x211*x315 - 8*x28 - x294*x316 - x301*x316 - 22*x313 - x314*x39 - x314*x43 - x314*x46 - 7*x335 + 56*x35*x69 - 7*x71 - 7*x72 - x73 - 13*x76
    d4L[...,21] = -x120*x321 + x120*x322 - x146*x221*x248 + x172 - x174*x194 - x174*x197 + x177*x221 - x234*x74 + x235*x74 + x236*x74 + x239*x74 + x242*x74 + x243*x74 + x244*x74 + x26*x321 - x26*x322 - x270*x74 + x317*x46 - x317 - x318*x39 - x318*x43 - x318*x46 + x318 + x319*x39 + x319*x43 + x319*x46 - x319 - x320*x46 + x320 + 6*x71 + 6*x72 + x81
    d4L[...,22] = -x120*x317 + x120*x318 + x170*x39 + x170*x43 + x170*x46 - x170 - x171*x46 + x171 - x194*x75 - x197*x75 - x221*x313 + x221*x70 + x250*x74 + x251*x74 + x252*x74 + x253*x74 + x26*x317 - x26*x318 - x274*x74 + x82
    d4L[...,23] = 10*x100*x101*x12*x18*x19*x38*x99 + 3*x12*x37*x39*x47*x48*x74 + 3*x12*x37*x43*x45*x47*x48*x74 + 3*x12*x37*x43*x47*x48*x74 + 4*x15*x16*x47*x48*x74*x83*x99 + 2*x15*x25*x47*x48*x74*x83*x99 - x167*x83 - 3*x174 - x177*x259 - x177*x260 + 8*x18*x189*x19*x38*x43*x45*x83 + 4*x18*x19*x37*x38 - x182 - x190*x323 - x194*x324 - x197*x324 - x203*x324 - x325*x46 - x326 - x77
    d4L[...,24] = 4*x100*x101*x18*x19*x37*x38 + 4*x12*x15*x16*x37*x47*x48*x74 + 2*x12*x15*x25*x37*x47*x48*x74 + 8*x12*x18*x19*x38*x43*x45*x99 - x121*x174 - x176*x249 - x177*x194 - x177*x197 - x177*x203 - x178 - x183 - x26*x325 - x267*x70
    d4L[...,25] = -x121*x75 + 2*x15*x25*x47*x48*x74*x8 - x168 - x173 + 8*x18*x19*x37*x38*x43*x45 - x184 - x203*x70 - x326
    d4L[...,26] = x181*x294 - x181*x300 + x181*x301 + x190*x328 + x194*x329 + x197*x329 + x203*x329 - x222*x329 + x327*x46 - x327 + x73 + 7*x79 + 7*x80
    d4L[...,27] = -x120*x330 + x180*x249 + x181*x194 + x181*x197 + x181*x203 - x181*x222 + x221*x78 + x26*x330 + x82
    d4L[...,28] = x184 + x194*x78 + x197*x78 + x203*x78 - x222*x78 + 2*x78
    d4L[...,29] = x30*(-x222 + x351)
    d4L[...,30] = 12*x100*x101*x185*x99 - 12*x186*x26 - x186*x294 + 8*x189*x331*x43*x45 - x190*x331 - x194*x332 - x197*x332 - x203*x332 - 7*x336 + 7*x37*x83 - 7*x85 - 7*x86 - x87
    d4L[...,31] = 6*x100*x101*x37*x83 - x185*x249 + 8*x185*x43*x45*x99 - x186*x194 - x186*x197 - x186*x203 - x221*x84 - x350*x84 - x88
    d4L[...,32] = -x187 - x194*x84 - x197*x84 - x203*x84 + 8*x37*x43*x45*x83 - 2*x84
    d4L[...,33] = 8*x12*x43*x45*x8 - x13*x194 - x13*x197 - x13*x203 - 2*x13
    d4L[...,34] = -x351 + 8*x43*x45
    
    return lnp, d1L, d2L, d3L, d4L

    


